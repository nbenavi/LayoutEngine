INTSourceChangelist:2219147
Availability:Public
Title:UE4 用のモデルを作成する
Crumbs:%ROOT%, Engine, Engine/Content, Engine/Content/Speedtree
Description:UE4 用の SpeedTree モデルを作成する

UE4 で使用するためのモデル作成は、プロジェクトの要件に応じて、単純または複雑なものになります。以下のセクションでは、UE4 内で有益な SpeedTree で可能なことについて詳細に説明します。

## モデルを作成する

標準の SpeedTree モデリングを使用して最高レベルの詳細度でモデルを作成します。初めて SpeedTree をご使用になる場合、このドキュメントで始めるか、いくつかの入門ビデオをご覧いただくことができます。多くの場合、ゼロから作成するよりは、既存モデルを編集する方が簡単であるということを覚えておいてください。

モデルを保存すると、いくつかのファイルが作成されます。例えば、"MyTree" というモデルを編集しているとします。以下のようなファイルが作成されます。

* `MyTree.spm` - 編集中の SpeedTree モデルです。変更する際に、Modeler で開くのがこのファイルです。
* `MyTree.srt` - モデルの最適化されたバージョンであり、UE4 にインポートするファイルです。
* `MyTree_Atlas.tga, MyTree_Atlas_Normal.tga` - モデル上のタイル処理されていないテクスチャ マップから作成されたテクスチャのアトラスとそれに関連する法線マップです。
* `MyTree_Atlas_Billboards.tga, MyTree_Atlas_Billboards_Normal.tga` - モデルを 360 度法線マップ化した画像で構成されるビルボード アトラスです。必要であれば、これは最も低い LOD としての役割を果たします。

## 静的な光源処理の準備をする

シーンで静的な光源処理を使用する場合、ライトマッピング UV 座標をセットアップする必要があります。SpeedTree では、UE4 のライトマスでの使用に適したモデルのアンラップされた UV テクスチャ座標一式が自動的に作成されます。モデルで静的光源処理を使用しない場合は、この手順をスキップできます。静的光源処理を使用する場合は、このステップは必須です。モデルに対して最良のライトマップを使用する方法については、ここをクリックしてください。

## モデルに風を追加する

SpeedTree モデラーにある風のアニメーションは UE4 に引き継がれます。モデルを適切に設定するには、Wind Wizard で開始するのが良いでしょう。このユーティリティは、いくつかの簡単な質問に対する回答に基づき風の設定を適用します。ここで「Fan」オブジェクトを選択し、プロパティを編集して風の挙動を微調整します。

特に重要なのは、「Presets」 グループにある 「Style」 プロパティです。このプロパティは、風の複雑さを設定し、UE4 の頂点シェーダーのパフォーマンスに直接影響を与えます。以下でオプションについて詳しく説明します。低品質/短いシェーダーから、高品質/より長いシェーダの順になっています。

* **None** - UE4 で、風のシェーダ コードは実行されません。これは SpeedTree モデルをレンダリングするのに絶対的に最速の方法ですが、それでもカメラはジオメトリに向けられ (必要であれば)、LOD 遷移はスムーズです。
* **Fastest** - モデルは前後に揺れますが、個々の枝や葉の動きはありません。
* **Fast** - モデルは前後に揺れて、葉はさざめきます。
* **Better** - モデルが揺れて、葉はさざめき、枝は個別に動きます。
* **Best** - モデルが揺れて、葉はさざめき、そり返り、枝は個別に動きます。
* **Palm** - 葉状体が風に吹かれてひるがえり、風の方向に動きます (葉は "Best" と同じような挙動を示します)。

UE4 のマテリアル エディタでエフェクトを取り消すことができますが、Modeler で設定したよりも高くすることはできません。パフォーマンスを最適化する必要があれば、多くの場合、モデルを "Best" または"Palm"を使用して調整して、UE4 で複雑さを軽減するのが良いでしょう。

## モデルに詳細度 (LOD) を追加する

[Tree] ジェネレータを選択して [Level of Detail] グループで [Enabled] をチェックすることで LOD (Level of Detail) が追加されます。このセクションで LOD の数も設定します。各ジェネレータには、LOD グループがあり、モデルのその部分の質をどのように落とすかを制御します。モデルで LOD を編集する方法の詳しい情報については、ここをクリックします。

## モデルの環境オクルージョンを計算する

SpeedTree は、モデルの頂点毎に環境オクルージョン値を計算します。こうした値は、UE4 のマテリアルの環境オクルージョン システムに接続するか、マテリアル シェーダにある他のもの何にでも接続することができます。環境オクルージョンを計算する詳しい情報については、ここをクリックします。

## モデルにコリジョン オブジェクトを追加する

一連の球体とカプセルを追加して、UE4 のコリジョン ボリュームとして使用することができます。コリジョン オブジェクトで作業を開始する一番早い方法は、「Tools -> Generate collision primitives…」 の順に選択し、SpeedTree に自動的に追加させます。詳しい情報については、ここをクリックしてください。